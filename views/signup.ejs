<!DOCTYPE html>
<html lang="en" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sign Up</title>
    <link rel="stylesheet" href="style.css" />
    <script
      src="https://kit.fontawesome.com/6ad00072de.js"
      crossorigin="anonymous"
      defer
    ></script>
    <style>
      .error-message {
        color: #ff4d4d;
        font-size: 14px;
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <h2 class="title">Sign <span>Up</span> to T.Nestia</h2>

    <div class="container">
      <form
        class="form active"
        action="/signup"
        method="post"
        id="signupForm"
        autocomplete="off"
      >
        <select
          name="role"
          id="role"
          required
          style="
            margin: 10px 0;
            padding: 12px;
            border-radius: 10px;
            border: none;
            background: #2a2a2a;
            color: #fff;
            box-shadow: inset 4px 4px 6px #1f1f1f, inset -4px -4px 6px #333333;
          "
        >
          <option value="">Select your profession</option>
          <option value="student">Student</option>
          <option value="teacher">Teacher</option>
        </select>
        <div class="error-message" id="roleError"></div>

        <input
          type="text"
          name="username"
          placeholder="Enter your Name"
          required
        />
        <div class="error-message" id="usernameError"></div>

        <input
          type="email"
          name="email"
          placeholder="Enter your Email"
          required
          pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.com$"
          title="Email must end with .com"
        />
        <div class="error-message" id="emailError"></div>

        <input
          type="password"
          name="password"
          placeholder="Password"
          required
          pattern="^(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
          title="Password must be at least 8 characters long, contain at least one uppercase letter, one number, and one special character."
        />
        <div class="error-message" id="passwordError"></div>

        <input
          type="password"
          name="confirmPassword"
          placeholder="Confirm Password"
          required
        />
        <div class="error-message" id="confirmPasswordError"></div>

        <button type="submit" class="btn">
          <i class="fas fa-user-plus"></i> Submit
        </button>

        <p class="or" style="margin-top: 15px">
          Already have an account? <a class="link" href="/login">Login</a>
        </p>
      </form>
    </div>

    <script>
      const form = document.getElementById("signupForm");
      const role = form.querySelector("#role");
      const username = form.querySelector('input[name="username"]');
      const email = form.querySelector('input[name="email"]');
      const password = form.querySelector('input[name="password"]');
      const confirmPassword = form.querySelector(
        'input[name="confirmPassword"]'
      );

      form.addEventListener("submit", (e) => {
        let valid = true;

        // Reset errors
        document.querySelectorAll(".error-message").forEach((el) => {
          el.textContent = "";
        });

        // Role validation
        if (role.value === "") {
          document.getElementById("roleError").textContent =
            "Please select your profession.";
          valid = false;
        }

        // Username validation
        if (username.value.trim().length < 3) {
          document.getElementById("usernameError").textContent =
            "Name must be at least 3 characters long.";
          valid = false;
        }

        // Email validation (.com only)
        const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.com$/;
        if (!emailPattern.test(email.value)) {
          document.getElementById("emailError").textContent =
            "Please enter a valid email ending with .com";
          valid = false;
        }

        // Password validation
        const passPattern =
          /^(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
        if (!passPattern.test(password.value)) {
          document.getElementById("passwordError").textContent =
            "Password must be 8+ chars, include 1 uppercase, 1 number & 1 special character.";
          valid = false;
        }

        // Confirm password
        if (password.value !== confirmPassword.value) {
          document.getElementById("confirmPasswordError").textContent =
            "Passwords do not match.";
          valid = false;
        }

        if (!valid) e.preventDefault();
      });
    </script>
  </body>
</html>
